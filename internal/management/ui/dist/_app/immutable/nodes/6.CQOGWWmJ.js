import{a as l,f as v,t as F}from"../chunks/BEu3xU8X.js";import"../chunks/BKxQFQd5.js";import{o as gt}from"../chunks/Vc4QFieL.js";import{p as ht,a as bt,s as r,c as o,g as e,r as s,b as n,m as f,f as xt,n as G,t as h,d as yt}from"../chunks/BTMJvSec.js";import{s as _}from"../chunks/Bcgy8Ni5.js";import{i as b}from"../chunks/CcCxq7f-.js";import{f as q,p as C,r as Rt,B as K,e as $t,i as wt}from"../chunks/C6q300kx.js";import{b as St}from"../chunks/l2SKR2qa.js";import{i as Ot}from"../chunks/DlHN4S8Y.js";import{f as Q}from"../chunks/oGKLGfrS.js";var Nt=v('<p class="muted">Loadingâ€¦</p>'),kt=v('<p class="muted"> </p>'),Tt=v('<p class="muted">No runs recorded yet.</p>'),Pt=v("<p> </p>"),Bt=v('<p class="error"> </p>'),It=v("<li><p><strong> </strong> </p> <!> <!></li>"),At=v('<ul class="run-list"></ul>'),Dt=v('<div class="panel"><p><strong>Runtime:</strong> </p> <p><strong>Service:</strong> </p> <p><strong>Next Run:</strong> </p> <label for="interval">Beat Interval (seconds)</label> <input id="interval" name="heartbeat_interval" type="number" min="1"/> <div class="inline"><!> <!></div> <!></div> <section class="panel"><h3>Recent Runs</h3> <!></section>',1),Jt=v('<p class="error" aria-live="polite"> </p>'),jt=v('<section><header class="page-header"><p class="kicker">Runtime</p> <h2>Heartbeat</h2> <p class="muted">Observe cycles and tune beat rate.</p></header> <!> <!></section>');function Kt(V,W){ht(W,!1);let R=f(!0),d=f(""),y=f(1800),$=f(!1),E=f(!1),H=f(""),w=f(""),S=f([]);async function O(){n(R,!0),n(d,"");try{const t=await q("/api/manage/heartbeat");n($,t.runtimeOnline),n(y,t.intervalSec||1800),n(E,!!t.running),n(H,t.nextRunAt||""),n(S,t.recentRuns||[])}catch(t){n(d,C(t))}finally{n(R,!1)}}async function X(){n(d,"");try{await q("/api/manage/heartbeat/interval",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({intervalSec:e(y)})}),await O()}catch(t){n(d,C(t))}}async function Y(){n(d,"");try{const t=await q("/api/manage/heartbeat/trigger",{method:"POST"});n(w,t.result||""),await O()}catch(t){n(d,C(t))}}gt(async()=>{await O()}),Ot();var N=jt(),L=r(o(N),2);{var Z=t=>{var u=Nt();l(t,u)},tt=t=>{var u=Dt(),x=xt(u),k=o(x),rt=r(o(k));s(k);var T=r(k,2),st=r(o(T));s(T);var P=r(T,2),nt=r(o(P));s(P);var B=r(P,4);Rt(B);var I=r(B,2),M=o(I);K(M,{type:"button",onclick:X,children:(a,i)=>{G();var g=F("Save Interval");l(a,g)},$$slots:{default:!0}});var ot=r(M,2);{let a=yt(()=>!e($));K(ot,{type:"button",onclick:Y,get disabled(){return e(a)},children:(i,g)=>{G();var p=F("Trigger Now");l(i,p)},$$slots:{default:!0}})}s(I);var it=r(I,2);{var lt=a=>{var i=kt(),g=o(i,!0);s(i),h(()=>_(g,e(w))),l(a,i)};b(it,a=>{e(w)&&a(lt)})}s(x);var U=r(x,2),vt=r(o(U),2);{var pt=a=>{var i=Tt();l(a,i)},ct=a=>{var i=At();$t(i,5,()=>e(S),wt,(g,p)=>{var A=It(),D=o(A),J=o(D),_t=o(J,!0);s(J);var dt=r(J);s(D);var z=r(D,2);{var ut=c=>{var m=Pt(),j=o(m,!0);s(m),h(()=>_(j,e(p).preview)),l(c,m)};b(z,c=>{e(p).preview&&c(ut)})}var ft=r(z,2);{var mt=c=>{var m=Bt(),j=o(m,!0);s(m),h(()=>_(j,e(p).error)),l(c,m)};b(ft,c=>{e(p).error&&c(mt)})}s(A),h(c=>{_(_t,e(p).status),_(dt,` / ${e(p).triggered_by??""} / ${c??""}`)},[()=>Q(e(p).started_at)]),l(g,A)}),s(i),l(a,i)};b(vt,a=>{e(S).length===0?a(pt):a(ct,!1)})}s(U),h(a=>{_(rt,` ${e($)?"Online":"Offline"}`),_(st,` ${e(E)?"Running":"Stopped"}`),_(nt,` ${a??""}`)},[()=>Q(e(H))]),St(B,()=>e(y),a=>n(y,a)),l(t,u)};b(L,t=>{e(R)?t(Z):t(tt,!1)})}var et=r(L,2);{var at=t=>{var u=Jt(),x=o(u,!0);s(u),h(()=>_(x,e(d))),l(t,u)};b(et,t=>{e(d)&&t(at)})}s(N),l(V,N),bt()}export{Kt as component};
