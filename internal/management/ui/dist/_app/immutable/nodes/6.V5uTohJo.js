import{a as l,f as v,t as F}from"../chunks/YeIyPrO1.js";import"../chunks/JjcR20PN.js";import{o as me}from"../chunks/7XJTIz-S.js";import{p as ge,a as he,s as r,c as o,g as t,r as s,b as n,m as d,f as be,n as G,t as h,e as xe}from"../chunks/B28Y1LK0.js";import{s as c}from"../chunks/DrRmIrL_.js";import{i as b}from"../chunks/CSigMgDx.js";import{f as C,p as D,e as ye,i as Re}from"../chunks/BSTHbYmA.js";import{r as $e,B as K}from"../chunks/CTMhrdmY.js";import{b as we}from"../chunks/BnWQKn17.js";import{i as Se}from"../chunks/B5oQgd4i.js";var Oe=v('<p class="muted">Loading...</p>'),Ne=v('<p class="muted"> </p>'),ke=v('<p class="muted">No runs recorded yet.</p>'),Pe=v("<p> </p>"),Te=v('<p class="error"> </p>'),Be=v("<li><p><strong> </strong> </p> <!> <!></li>"),Ie=v('<ul class="run-list"></ul>'),Ae=v('<div class="panel"><p><strong>Runtime:</strong> </p> <p><strong>Service:</strong> </p> <p><strong>Next Run:</strong> </p> <label for="interval">Beat Interval (seconds)</label> <input id="interval" name="heartbeat_interval" type="number" min="1"/> <div class="inline"><!> <!></div> <!></div> <section class="panel"><h3>Recent Runs</h3> <!></section>',1),Je=v('<p class="error" aria-live="polite"> </p>'),je=v('<section><header class="page-header"><p class="kicker">Runtime</p> <h2>Heartbeat</h2> <p class="muted">Observe cycles and tune beat rate.</p></header> <!> <!></section>');function Ge(Q,V){ge(V,!1);let R=d(!0),_=d(""),y=d(1800),$=d(!1),E=d(!1),H=d(""),w=d(""),S=d([]);async function O(){n(R,!0),n(_,"");try{const e=await C("/api/manage/heartbeat");n($,e.runtimeOnline),n(y,e.intervalSec||1800),n(E,!!e.running),n(H,e.nextRunAt||""),n(S,e.recentRuns||[])}catch(e){n(_,D(e))}finally{n(R,!1)}}async function W(){n(_,"");try{await C("/api/manage/heartbeat/interval",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({intervalSec:t(y)})}),await O()}catch(e){n(_,D(e))}}async function X(){n(_,"");try{const e=await C("/api/manage/heartbeat/trigger",{method:"POST"});n(w,e.result||""),await O()}catch(e){n(_,D(e))}}me(async()=>{await O()}),Se();var N=je(),L=r(o(N),2);{var Y=e=>{var u=Oe();l(e,u)},Z=e=>{var u=Ae(),x=be(u),k=o(x),ae=r(o(k));s(k);var P=r(k,2),re=r(o(P));s(P);var T=r(P,2),se=r(o(T));s(T);var B=r(T,4);$e(B);var I=r(B,2),M=o(I);K(M,{type:"button",onclick:W,children:(a,i)=>{G();var g=F("Save Interval");l(a,g)},$$slots:{default:!0}});var ne=r(M,2);{let a=xe(()=>!t($));K(ne,{type:"button",onclick:X,get disabled(){return t(a)},children:(i,g)=>{G();var p=F("Trigger Now");l(i,p)},$$slots:{default:!0}})}s(I);var oe=r(I,2);{var ie=a=>{var i=Ne(),g=o(i,!0);s(i),h(()=>c(g,t(w))),l(a,i)};b(oe,a=>{t(w)&&a(ie)})}s(x);var U=r(x,2),le=r(o(U),2);{var ve=a=>{var i=ke();l(a,i)},pe=a=>{var i=Ie();ye(i,5,()=>t(S),Re,(g,p)=>{var A=Be(),J=o(A),j=o(J),ce=o(j,!0);s(j);var _e=r(j);s(J);var z=r(J,2);{var ue=f=>{var m=Pe(),q=o(m,!0);s(m),h(()=>c(q,t(p).preview)),l(f,m)};b(z,f=>{t(p).preview&&f(ue)})}var de=r(z,2);{var fe=f=>{var m=Te(),q=o(m,!0);s(m),h(()=>c(q,t(p).error)),l(f,m)};b(de,f=>{t(p).error&&f(fe)})}s(A),h(()=>{c(ce,t(p).status),c(_e,` / ${t(p).triggered_by??""} / ${t(p).started_at??""}`)}),l(g,A)}),s(i),l(a,i)};b(le,a=>{t(S).length===0?a(ve):a(pe,!1)})}s(U),h(()=>{c(ae,` ${t($)?"Online":"Offline"}`),c(re,` ${t(E)?"Running":"Stopped"}`),c(se,` ${(t(H)||"n/a")??""}`)}),we(B,()=>t(y),a=>n(y,a)),l(e,u)};b(L,e=>{t(R)?e(Y):e(Z,!1)})}var ee=r(L,2);{var te=e=>{var u=Je(),x=o(u,!0);s(u),h(()=>c(x,t(_))),l(e,u)};b(ee,e=>{t(_)&&e(te)})}s(N),l(Q,N),he()}export{Ge as component};
